<!DOCTYPE html>
<html>
<head>
  <title>Green House</title>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.2/css/bootstrap.min.css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/animate.css/3.2.0/animate.min.css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/angularjs-toaster/0.4.10/toaster.min.css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/animate.css/3.2.0/animate.min.css" />

  <style type="text/css">
    body {
      min-height: 2000px;
      padding-top: 70px;
    }

    .green {
      color: green;
    }

    .yellow {
      color: yellow;
    }
    .red {
      color: #a94442;
    }
  </style>
</head>
<body>

  <div>

    <div data-ng-include="'header.html'"></div>

    <div class="container body-content ui-view-container" role="main">
      <div ng-view data-ng-view-animate="zoomIn"></div>
    </div>

    <div data-ng-include="'footer.html'"></div>

  </div>
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.2/js/bootstrap.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/toastr.js/2.1.0/js/toastr.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.9.0/moment.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/bootbox.js/4.3.0/bootbox.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/angular.js/1.3.8/angular.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/angular.js/1.3.12/angular-sanitize.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/angular.js/1.3.8/angular-route.min.js"></script>
  <!--<script src=" />/cdnjs.cloudflare.com/ajax/libs/angular-ui-router/0.2.13/angular-ui-router.min.js"></script>-->
  <script src="//cdnjs.cloudflare.com/ajax/libs/angular.js/1.3.12/angular-animate.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/angular-ui-bootstrap/0.12.0/ui-bootstrap-tpls.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/angular-ui-utils/0.1.1/angular-ui-utils.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/Chart.js/1.0.1/Chart.min.js"></script>


  <script type="text/ng-template" id="header.html">
    <nav class="navbar navbar-default navbar-fixed-top">
      <div class="container">

        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar123" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#"><i class="fa fa-leaf green"></i> Green House</a>
        </div>


        <div id="navbar123" class="navbar-collapse collapse" aria-expanded="false" style="height: 1px;">
          <ul class="nav navbar-nav">
            <li data-toggle="tooltip" data-placement="bottom" title="time since last reboot"><a href="#"><i class="fa fa-heartbeat green"></i> <span>4 days</span></a></li>
            <li data-toggle="tooltip" data-placement="bottom" title="Free RAM 417b"><a href="#"><i class="fa fa-tachometer green"></i> <span>Ok</span></a></li>
            <li data-toggle="tooltip" data-placement="bottom" title="click to refresh"><a href="#"><i class="fa fa-refresh green"></i> <span>2015 May 22 13:32:15</span></a></li>
          </ul>
          <ul class="nav navbar-nav navbar-right">
            <li>
              <a href="#" >
                <div class="btn-group" role="group">
                  <span type="button" class="btn btn-primary active">C&deg;</span>
                  <span type="button" class="btn btn-default">F&deg;</span>
                </div>
              </a>
            </li>
           </ul>
          </div> <!-- /.navbar-collapse -->

      </div>   <!-- /.container-fluid -->
    </nav>
  </script>

  <script type="text/ng-template" id="footer.html">

    <footer class="navbar navbar-default navbar-fixed-bottom text-center">
      <div class="container">
        <ul class="nav navbar-nav animated fadeIn">
          <li><a target="_blank" href="https://github.com/miticv/ArduinoGreenHouseApp">&copy; 2015 - Arduino Green House App <i class="fa fa-external-link"></i></a></li>          
        </ul>
        <ul class="nav navbar-nav navbar-right">
          <li><a ng-hide="layout.isLoggedIn" href="/admin"><i class="fa fa-wrench"></i> admin</a></li>
        </ul>
      </div>
    </footer>
  </script>

  <script type="text/ng-template" id="home.html">

    <div class="panel panel-default">
      <div class="panel-heading"><i class="fa fa-cloud"></i> Air</div>
      <div class="panel-body">
        <div class="row">
          <div class="col-sm-6">
            <ul class="list-group">
              <a href="#" class="list-group-item active">
                <i class="fa fa-cloud-download"></i> Air Inside
              </a>
              <li class="list-group-item  list-group-item-warning"><span class="badge">10 C&deg;</span> Temperature</li>
              <li class="list-group-item  list-group-item-success"><i class="fa fa-tint"></i><span class="badge">80 &#37;</span> Humidity</li>
              <li class="list-group-item  list-group-item-warning"><i class="fa fa-fire"></i><span class="badge">32 </span> Heat Index</li>
              <li class="list-group-item  list-group-item-success"><i class="fa fa-sun-o"></i><span class="badge">780 lux</span> Light</li>
            </ul>
          </div><!-- /.col-sm-6 -->
          <div class="col-sm-6">
            <ul class="list-group">
              <a href="#" class="list-group-item active">
                <i class="fa fa-cloud-upload"></i> Air Outside <i class="fa fa-exclamation-triangle red"></i>
              </a>
              <li class="list-group-item  list-group-item-danger"><span class="badge">-18 C&deg;</span> Temperature</li>
              <li class="list-group-item  list-group-item-success"><i class="fa fa-tint"></i><span class="badge">20 &#37;</span> Humidity</li>
              <li class="list-group-item  list-group-item-warning"><i class="fa fa-fire"></i><span class="badge">5 </span> Heat Index</li>
              <li class="list-group-item  list-group-item-success"><i class="fa fa-sun-o"></i><span class="badge">830 lux</span> Light</li>
            </ul>
          </div><!-- /.col-sm-6 -->
        </div>
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading"><i class="fa fa-cloud"></i> Pool</div>
      <div class="panel-body">
        <div class="row">
          <div class="col-sm-6">
            <div class="list-group">
              <a href="#" class="list-group-item active">
                Pool Water
              </a>
              <a href="#" class="list-group-item list-group-item-success"><i class="fa fa-arrows-v"></i> <span class="badge">5 m</span> Level</a>              
              <a href="#" class="list-group-item list-group-item-success"><i class="fa fa-long-arrow-up"></i><span class="badge">12 C&deg;</span> Temperature top</a>
              <a href="#" class="list-group-item list-group-item-success"><i class="fa fa-long-arrow-down"></i><span class="badge">10 C&deg;</span> Temperature bottom </a>
              <a href="#" class="list-group-item list-group-item-success"><i class="fa fa-plug"></i><i class="fa fa-cog fa-spin fa-2x green pull-right"></i> Pump Running</a>
            </div>
          </div><!-- /.col-sm-6 -->
          <div class="col-sm-6">
            <div class="list-group">
              <a href="#" class="list-group-item active">
                Water Beds
              </a>
              <a href="#" class="list-group-item list-group-item-success"><i class="fa fa-arrows-v"></i> <span class="badge">5 m</span> Bed A </a>
              <a href="#" class="list-group-item list-group-item-success"><i class="fa fa-long-arrow-up"></i><span class="badge">12 C&deg;</span>Bed B </a>
              <a href="#" class="list-group-item list-group-item-success"><i class="fa fa-long-arrow-down"></i><span class="badge">10 C&deg;</span>Bed C  </a>
              <a href="#" class="list-group-item list-group-item-success"><i class="fa fa-plug"></i><i class="fa fa-cog fa-spin fa-2x green pull-right"></i>Bed C </a>
            </div>
          </div><!-- /.col-sm-6 -->
        </div>
      </div>
    </div>

  </script>


  <script>
    angular.module('greenhouse', ['ngRoute']).
      config(['$routeProvider', function ($routeProvider) {
        $routeProvider.
         when("/", { templateUrl: "home.html", controller: "homeController" }).
         when("/admin", { templateUrl: "admin.html", controller: "adminController" }).
         otherwise({ redirectTo: '/' });
      }]);

    angular.module('greenhouse').
      service("greenApiService", ['$http', '$q', function ($http, $q) {

        return ({
          
          getSensorData: getSensorData,
          getHistoryLog: getHistoryLog,
          getMonthData: getMonthData,
          getYearData: getYearData,

          isAdmin: isAdmin,
          setDateTime: setDateTime,
          doReboot: doReboot,
          viewFiles: viewFiles,
          setRefreshTime: setRefreshTime

        });

        function getSensorData() {
          //var request = $http({
          //  method: "get",
          //  url: "isadmin",
          //  params: {
          //    action: "get"
          //  }
          //});
          //return (request.then(handleSuccess, handleError));
          return {  "Datetime":"2015-02-13 01:22:14", "AnalogSignal1":"5", "AnalogSignal2":"10", "AnalogSignal3":"11" };
        }

        function getHistoryLog() {
          var request = $http({
            method: "get",
            url: "admin",
            params: {
              action: "get"
            }
          });
          return (request.then(handleSuccess, handleError));
        }

        function getMonthData() {
          var request = $http({
            method: "get",
            url: "admin",
            params: {
              action: "get"
            }
          });
          return (request.then(handleSuccess, handleError));
        }

        function getYearData() {
          var request = $http({
            method: "get",
            url: "admin",
            params: {
              action: "get"
            }
          });
          return (request.then(handleSuccess, handleError));
        }

        //ADMIN FUNCTIONS
        function isAdmin(pass) {

          var request = $http({
            method: "delete",
            url: "api/index.cfm",
            params: {
              action: "post"
            },
            data: {
              id: id
            }
          });

          return (request.then(handleSuccess, handleError));

        }

        function setDateTime(year, month, day, hour, min, sec, week) {

          var request = $http({
            method: "delete",
            url: "api/index.cfm",
            params: {
              action: "post"
            },
            data: {
              id: id
            }
          });

          return (request.then(handleSuccess, handleError));

        }

        function doReboot() {

          var request = $http({
            method: "delete",
            url: "api/index.cfm",
            params: {
              action: "post"
            },
            data: {
              id: id
            }
          });

          return (request.then(handleSuccess, handleError));

        }

        function viewFiles() {

          var request = $http({
            method: "delete",
            url: "api/index.cfm",
            params: {
              action: "post"
            },
            data: {
              id: id
            }
          });

          return (request.then(handleSuccess, handleError));

        }

        function setRefreshTime(pariod) {

          var request = $http({
            method: "delete",
            url: "api/index.cfm",
            params: {
              action: "post"
            },
            data: {
              id: id
            }
          });

          return (request.then(handleSuccess, handleError));

        }

        function handleError(response) {
          if (
              !angular.isObject(response.data) ||
              !response.data.message
              ) {
            return ($q.reject("An unknown error occurred."));
          }
          return ($q.reject(response.data.message));
        }

        function handleSuccess(response) {
          return (response.data);
        }
    }]);


    angular.module('greenhouse').
      controller('homeController', ['$scope', 'greenApiService', function ($scope, greenApiService) {

        $scope.getData = function () {
          greenApiService.getSensorData();
        };

      }]);

    angular.module('greenhouse').
      controller('adminController', ['$scope', 'greenApiService', function ($scope, greenApiService) {

      }]);


  </script>

  <script>
    $(document).ready(function () {
      angular.bootstrap(document, ['greenhouse']);
      $('[data-toggle="tooltip"]').tooltip();
    });
  </script>

</body>
</html>